加载数据...
Time usage: 0:00:03
Some weights of the model checkpoint at ./bert_pretrain were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Epoch [1/3]
Iter:      0,  Train Loss:   1.6,  Train Acc: 20.31%,  Val Loss:   1.6,  Val Acc: 21.31%,  Time: 0:00:02 *
Iter:     10,  Train Loss:   1.4,  Train Acc: 54.69%,  Val Loss:   1.3,  Val Acc: 62.07%,  Time: 0:00:05 *
Iter:     20,  Train Loss:   1.1,  Train Acc: 67.19%,  Val Loss:   1.1,  Val Acc: 66.69%,  Time: 0:00:07 *
Iter:     30,  Train Loss:   1.0,  Train Acc: 64.06%,  Val Loss:  0.85,  Val Acc: 72.10%,  Time: 0:00:09 *
Iter:     40,  Train Loss:   0.7,  Train Acc: 76.56%,  Val Loss:  0.75,  Val Acc: 74.41%,  Time: 0:00:12 *
Iter:     50,  Train Loss:  0.66,  Train Acc: 81.25%,  Val Loss:   0.7,  Val Acc: 75.69%,  Time: 0:00:14 *
Iter:     60,  Train Loss:  0.72,  Train Acc: 73.44%,  Val Loss:   0.7,  Val Acc: 74.72%,  Time: 0:00:17 *
Iter:     70,  Train Loss:  0.78,  Train Acc: 68.75%,  Val Loss:  0.77,  Val Acc: 73.58%,  Time: 0:00:18 
Iter:     80,  Train Loss:  0.71,  Train Acc: 70.31%,  Val Loss:  0.74,  Val Acc: 73.13%,  Time: 0:00:19 
Iter:     90,  Train Loss:   0.8,  Train Acc: 68.75%,  Val Loss:  0.69,  Val Acc: 75.72%,  Time: 0:00:22 *
Iter:    100,  Train Loss:  0.74,  Train Acc: 73.44%,  Val Loss:  0.68,  Val Acc: 76.16%,  Time: 0:00:24 *
Iter:    110,  Train Loss:  0.89,  Train Acc: 65.62%,  Val Loss:  0.66,  Val Acc: 76.99%,  Time: 0:00:27 *
Iter:    120,  Train Loss:  0.78,  Train Acc: 71.88%,  Val Loss:  0.66,  Val Acc: 76.60%,  Time: 0:00:29 *
Iter:    130,  Train Loss:  0.57,  Train Acc: 75.00%,  Val Loss:  0.68,  Val Acc: 76.08%,  Time: 0:00:30 
Iter:    140,  Train Loss:   0.5,  Train Acc: 78.12%,  Val Loss:  0.68,  Val Acc: 76.13%,  Time: 0:00:32 
Iter:    150,  Train Loss:  0.61,  Train Acc: 79.69%,  Val Loss:   0.7,  Val Acc: 75.99%,  Time: 0:00:33 
Iter:    160,  Train Loss:  0.48,  Train Acc: 85.94%,  Val Loss:   0.7,  Val Acc: 75.49%,  Time: 0:00:34 
Iter:    170,  Train Loss:  0.75,  Train Acc: 75.00%,  Val Loss:  0.67,  Val Acc: 76.30%,  Time: 0:00:36 
Iter:    180,  Train Loss:  0.61,  Train Acc: 79.69%,  Val Loss:  0.67,  Val Acc: 76.30%,  Time: 0:00:37 
Iter:    190,  Train Loss:  0.54,  Train Acc: 78.12%,  Val Loss:  0.66,  Val Acc: 76.99%,  Time: 0:00:38 
Iter:    200,  Train Loss:   0.5,  Train Acc: 85.94%,  Val Loss:  0.66,  Val Acc: 76.77%,  Time: 0:00:41 *
Iter:    210,  Train Loss:  0.59,  Train Acc: 81.25%,  Val Loss:  0.66,  Val Acc: 76.63%,  Time: 0:00:42 
Iter:    220,  Train Loss:   0.6,  Train Acc: 75.00%,  Val Loss:  0.68,  Val Acc: 76.16%,  Time: 0:00:43 
Iter:    230,  Train Loss:  0.67,  Train Acc: 76.56%,  Val Loss:  0.65,  Val Acc: 76.88%,  Time: 0:00:46 *
Epoch [2/3]
Iter:    240,  Train Loss:  0.57,  Train Acc: 79.69%,  Val Loss:  0.65,  Val Acc: 76.72%,  Time: 0:00:47 
Iter:    250,  Train Loss:  0.55,  Train Acc: 76.56%,  Val Loss:  0.64,  Val Acc: 77.58%,  Time: 0:00:49 *
Iter:    260,  Train Loss:  0.98,  Train Acc: 64.06%,  Val Loss:  0.66,  Val Acc: 76.22%,  Time: 0:00:51 
Iter:    270,  Train Loss:  0.58,  Train Acc: 73.44%,  Val Loss:  0.67,  Val Acc: 76.33%,  Time: 0:00:52 
Iter:    280,  Train Loss:  0.79,  Train Acc: 70.31%,  Val Loss:  0.67,  Val Acc: 76.13%,  Time: 0:00:53 
Iter:    290,  Train Loss:  0.61,  Train Acc: 78.12%,  Val Loss:  0.65,  Val Acc: 77.19%,  Time: 0:00:55 
Iter:    300,  Train Loss:  0.62,  Train Acc: 78.12%,  Val Loss:  0.65,  Val Acc: 77.44%,  Time: 0:00:56 
Iter:    310,  Train Loss:  0.66,  Train Acc: 76.56%,  Val Loss:  0.65,  Val Acc: 77.33%,  Time: 0:00:57 
Iter:    320,  Train Loss:   0.8,  Train Acc: 75.00%,  Val Loss:  0.67,  Val Acc: 76.58%,  Time: 0:00:59 
Iter:    330,  Train Loss:   0.6,  Train Acc: 79.69%,  Val Loss:  0.65,  Val Acc: 76.80%,  Time: 0:01:00 
Iter:    340,  Train Loss:  0.66,  Train Acc: 73.44%,  Val Loss:  0.64,  Val Acc: 77.41%,  Time: 0:01:02 *
Iter:    350,  Train Loss:  0.66,  Train Acc: 78.12%,  Val Loss:  0.65,  Val Acc: 77.16%,  Time: 0:01:04 
Iter:    360,  Train Loss:  0.64,  Train Acc: 75.00%,  Val Loss:  0.65,  Val Acc: 76.74%,  Time: 0:01:05 
Iter:    370,  Train Loss:  0.67,  Train Acc: 73.44%,  Val Loss:  0.67,  Val Acc: 76.74%,  Time: 0:01:06 
Iter:    380,  Train Loss:  0.63,  Train Acc: 81.25%,  Val Loss:  0.67,  Val Acc: 76.08%,  Time: 0:01:07 
Iter:    390,  Train Loss:  0.59,  Train Acc: 78.12%,  Val Loss:  0.65,  Val Acc: 77.30%,  Time: 0:01:09 
Iter:    400,  Train Loss:  0.57,  Train Acc: 84.38%,  Val Loss:  0.64,  Val Acc: 77.24%,  Time: 0:01:11 *
Iter:    410,  Train Loss:  0.62,  Train Acc: 76.56%,  Val Loss:  0.66,  Val Acc: 76.66%,  Time: 0:01:13 
Iter:    420,  Train Loss:  0.71,  Train Acc: 73.44%,  Val Loss:  0.65,  Val Acc: 76.91%,  Time: 0:01:14 
Iter:    430,  Train Loss:  0.61,  Train Acc: 81.25%,  Val Loss:  0.64,  Val Acc: 77.08%,  Time: 0:01:15 
Iter:    440,  Train Loss:  0.69,  Train Acc: 81.25%,  Val Loss:  0.65,  Val Acc: 76.72%,  Time: 0:01:16 
Iter:    450,  Train Loss:  0.56,  Train Acc: 76.56%,  Val Loss:  0.65,  Val Acc: 77.08%,  Time: 0:01:18 
Iter:    460,  Train Loss:  0.59,  Train Acc: 78.12%,  Val Loss:  0.65,  Val Acc: 77.41%,  Time: 0:01:19 
Epoch [3/3]
Iter:    470,  Train Loss:  0.66,  Train Acc: 79.69%,  Val Loss:  0.65,  Val Acc: 76.72%,  Time: 0:01:20 
Iter:    480,  Train Loss:  0.46,  Train Acc: 82.81%,  Val Loss:  0.66,  Val Acc: 76.55%,  Time: 0:01:22 
Iter:    490,  Train Loss:  0.54,  Train Acc: 76.56%,  Val Loss:  0.66,  Val Acc: 76.33%,  Time: 0:01:23 
Iter:    500,  Train Loss:  0.78,  Train Acc: 71.88%,  Val Loss:  0.65,  Val Acc: 77.27%,  Time: 0:01:24 
Iter:    510,  Train Loss:  0.47,  Train Acc: 82.81%,  Val Loss:  0.66,  Val Acc: 76.77%,  Time: 0:01:26 
Iter:    520,  Train Loss:   0.5,  Train Acc: 87.50%,  Val Loss:  0.65,  Val Acc: 77.05%,  Time: 0:01:27 
Iter:    530,  Train Loss:  0.54,  Train Acc: 78.12%,  Val Loss:  0.65,  Val Acc: 76.77%,  Time: 0:01:28 
Iter:    540,  Train Loss:  0.66,  Train Acc: 75.00%,  Val Loss:  0.69,  Val Acc: 76.22%,  Time: 0:01:30 
Iter:    550,  Train Loss:  0.54,  Train Acc: 82.81%,  Val Loss:  0.66,  Val Acc: 76.52%,  Time: 0:01:31 
Iter:    560,  Train Loss:  0.67,  Train Acc: 73.44%,  Val Loss:  0.64,  Val Acc: 77.24%,  Time: 0:01:33 *
Iter:    570,  Train Loss:  0.72,  Train Acc: 75.00%,  Val Loss:  0.64,  Val Acc: 77.52%,  Time: 0:01:35 
Iter:    580,  Train Loss:  0.58,  Train Acc: 75.00%,  Val Loss:  0.63,  Val Acc: 77.58%,  Time: 0:01:37 *
Iter:    590,  Train Loss:  0.74,  Train Acc: 70.31%,  Val Loss:  0.64,  Val Acc: 76.85%,  Time: 0:01:38 
Iter:    600,  Train Loss:  0.52,  Train Acc: 81.25%,  Val Loss:  0.64,  Val Acc: 77.02%,  Time: 0:01:40 
Iter:    610,  Train Loss:  0.45,  Train Acc: 78.12%,  Val Loss:  0.64,  Val Acc: 76.91%,  Time: 0:01:41 
Iter:    620,  Train Loss:  0.47,  Train Acc: 85.94%,  Val Loss:  0.65,  Val Acc: 77.30%,  Time: 0:01:42 
Iter:    630,  Train Loss:  0.41,  Train Acc: 84.38%,  Val Loss:  0.65,  Val Acc: 76.69%,  Time: 0:01:44 
Iter:    640,  Train Loss:  0.59,  Train Acc: 76.56%,  Val Loss:  0.63,  Val Acc: 77.16%,  Time: 0:01:46 *
Iter:    650,  Train Loss:  0.65,  Train Acc: 76.56%,  Val Loss:  0.64,  Val Acc: 77.22%,  Time: 0:01:47 
Iter:    660,  Train Loss:  0.46,  Train Acc: 82.81%,  Val Loss:  0.64,  Val Acc: 77.19%,  Time: 0:01:49 
Iter:    670,  Train Loss:  0.47,  Train Acc: 79.69%,  Val Loss:  0.63,  Val Acc: 76.94%,  Time: 0:01:50 
Iter:    680,  Train Loss:  0.59,  Train Acc: 81.25%,  Val Loss:  0.63,  Val Acc: 77.85%,  Time: 0:01:52 *
Iter:    690,  Train Loss:   0.5,  Train Acc: 79.69%,  Val Loss:  0.64,  Val Acc: 77.30%,  Time: 0:01:54 
Iter:    700,  Train Loss:   0.6,  Train Acc: 76.56%,  Val Loss:  0.63,  Val Acc: 77.33%,  Time: 0:01:55 
Test Loss:  0.63,  Test Acc: 77.85%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

         car     0.8610    0.8066    0.8329       791
     culture     0.7725    0.7337    0.7526       736
         edu     0.6645    0.8065    0.7287       646
        game     0.8035    0.7572    0.7797       659
      sports     0.8011    0.7875    0.7942       767

    accuracy                         0.7785      3599
   macro avg     0.7805    0.7783    0.7776      3599
weighted avg     0.7843    0.7785    0.7798      3599

Confusion Matrix...
[[638  38  59  26  30]
 [ 21 540 128  25  22]
 [ 22  54 521  21  28]
 [ 24  32  34 499  70]
 [ 36  35  42  50 604]]
Time usage: 0:00:01
7,899,557 total parameters.
Epoch [1/3]
Traceback (most recent call last):
  File "/home/huyiwen/KnowledgeDistillation/distill.py", line 40, in <module>
    student_train(T_model, S_model, cfg, train_loader, test_loader)
  File "/home/huyiwen/KnowledgeDistillation/student.py", line 60, in student_train
    train_acc = metrics.accuracy_score(label.long(), torch.max(cur_pred, 1)[1].cpu().numpy())
  File "/home/huyiwen/anaconda3/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 192, in wrapper
    return func(*args, **kwargs)
  File "/home/huyiwen/anaconda3/lib/python3.10/site-packages/sklearn/metrics/_classification.py", line 221, in accuracy_score
    y_type, y_true, y_pred = _check_targets(y_true, y_pred)
  File "/home/huyiwen/anaconda3/lib/python3.10/site-packages/sklearn/metrics/_classification.py", line 87, in _check_targets
    type_true = type_of_target(y_true, input_name="y_true")
  File "/home/huyiwen/anaconda3/lib/python3.10/site-packages/sklearn/utils/multiclass.py", line 298, in type_of_target
    if is_multilabel(y):
  File "/home/huyiwen/anaconda3/lib/python3.10/site-packages/sklearn/utils/multiclass.py", line 161, in is_multilabel
    y = xp.asarray(y)
  File "/home/huyiwen/anaconda3/lib/python3.10/site-packages/sklearn/utils/_array_api.py", line 75, in asarray
    return numpy.asarray(x, dtype=dtype)
  File "/home/huyiwen/anaconda3/lib/python3.10/site-packages/torch/_tensor.py", line 970, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
