加载数据...
['a stirring , funny and finally transporting re-imagining of beauty and the beast and 1930s horror films', 'apparently reassembled from the cutting-room floor of any given daytime soap .', "they presume their audience wo n't sit still for a sociology lesson , however entertainingly presented , so they trot out the conventional science-fiction elements of bug-eyed monsters and futuristic women in skimpy clothes .", 'this is a visually stunning rumination on love , memory , history and the war between art and commerce .', "jonathan parker 's bartleby should have been the be-all-end-all of the modern-office anomie films ."]
[1, 0, 0, 1, 1]
Time usage: 0:00:13
Some weights of the model checkpoint at /home/huyiwen/pretrained/bert-base-uncased-SST-2 were not used when initializing BertModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
BERT_Model(
  (bert): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0-11): 12 x BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (fc): Linear(in_features=768, out_features=192, bias=True)
  (fc1): Linear(in_features=192, out_features=2, bias=True)
)
cuda
biLSTM(
  (Embedding): Embedding(30522, 300)
  (lstm): LSTM(300, 300, batch_first=True, bidirectional=True)
  (fc1): LinearDecomMPO(
    mpo=True, in_features=600, out_features=192, bias=True
    (tensor_set): ParameterList(
        (0): Parameter containing: [torch.float32 of size 1x10x6x60 (cuda:0)]
        (1): Parameter containing: [torch.float32 of size 60x2x2x240 (cuda:0)]
        (2): Parameter containing: [torch.float32 of size 240x1x1x240 (cuda:0)]
        (3): Parameter containing: [torch.float32 of size 240x3x2x80 (cuda:0)]
        (4): Parameter containing: [torch.float32 of size 80x10x8x1 (cuda:0)]
    )
  )
  (fc2): LinearDecomMPO(
    mpo=True, in_features=192, out_features=2, bias=True
    (tensor_set): ParameterList(
        (0): Parameter containing: [torch.float32 of size 1x6x2x12 (cuda:0)]
        (1): Parameter containing: [torch.float32 of size 12x2x1x16 (cuda:0)]
        (2): Parameter containing: [torch.float32 of size 16x1x1x16 (cuda:0)]
        (3): Parameter containing: [torch.float32 of size 16x2x1x8 (cuda:0)]
        (4): Parameter containing: [torch.float32 of size 8x8x1x1 (cuda:0)]
    )
  )
)
10,843,098 total parameters.
Epoch [1/30]
base_loss tensor(0.9382, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4529, device='cuda:0', grad_fn=<MseLossBackward0>)
0.24553876
base_loss tensor(0.8906, device='cuda:0') distillation_loss tensor(0.4649, device='cuda:0')
0.0
base_loss tensor(0.7094, device='cuda:0') distillation_loss tensor(0.3613, device='cuda:0')
0.0
base_loss tensor(0.8466, device='cuda:0') distillation_loss tensor(0.4440, device='cuda:0')
0.0
base_loss tensor(0.7737, device='cuda:0') distillation_loss tensor(0.4927, device='cuda:0')
0.0
base_loss tensor(0.8412, device='cuda:0') distillation_loss tensor(0.3877, device='cuda:0')
0.0
base_loss tensor(0.8601, device='cuda:0') distillation_loss tensor(0.4484, device='cuda:0')
0.0
base_loss tensor(0.8445, device='cuda:0') distillation_loss tensor(0.4241, device='cuda:0')
0.0
base_loss tensor(0.7629, device='cuda:0') distillation_loss tensor(0.4422, device='cuda:0')
0.0
base_loss tensor(0.7483, device='cuda:0') distillation_loss tensor(0.4587, device='cuda:0')
0.0
base_loss tensor(0.8702, device='cuda:0') distillation_loss tensor(0.5439, device='cuda:0')
0.0
base_loss tensor(0.7990, device='cuda:0') distillation_loss tensor(0.4439, device='cuda:0')
0.0
base_loss tensor(0.7853, device='cuda:0') distillation_loss tensor(0.3649, device='cuda:0')
0.0
base_loss tensor(0.9018, device='cuda:0') distillation_loss tensor(0.4433, device='cuda:0')
0.0
base_loss tensor(0.7914, device='cuda:0') distillation_loss tensor(0.4200, device='cuda:0')
0.0
base_loss tensor(0.7927, device='cuda:0') distillation_loss tensor(0.4588, device='cuda:0')
0.0
base_loss tensor(0.9228, device='cuda:0') distillation_loss tensor(0.6024, device='cuda:0')
0.0
base_loss tensor(0.7851, device='cuda:0') distillation_loss tensor(0.5007, device='cuda:0')
0.0
base_loss tensor(0.8534, device='cuda:0') distillation_loss tensor(0.5179, device='cuda:0')
0.0
base_loss tensor(0.6270, device='cuda:0') distillation_loss tensor(0.4316, device='cuda:0')
0.0
base_loss tensor(0.8648, device='cuda:0') distillation_loss tensor(0.4353, device='cuda:0')
0.0
base_loss tensor(0.8291, device='cuda:0') distillation_loss tensor(0.4006, device='cuda:0')
0.0
base_loss tensor(0.7999, device='cuda:0') distillation_loss tensor(0.5052, device='cuda:0')
0.0
base_loss tensor(0.8363, device='cuda:0') distillation_loss tensor(0.3753, device='cuda:0')
0.0
base_loss tensor(0.7649, device='cuda:0') distillation_loss tensor(0.4336, device='cuda:0')
0.0
base_loss tensor(0.7993, device='cuda:0') distillation_loss tensor(0.5380, device='cuda:0')
0.0
base_loss tensor(0.7229, device='cuda:0') distillation_loss tensor(0.4392, device='cuda:0')
0.0
base_loss tensor(0.8130, device='cuda:0') distillation_loss tensor(0.5412, device='cuda:0')
0.0
base_loss tensor(0.7638, device='cuda:0') distillation_loss tensor(0.4890, device='cuda:0')
0.0
base_loss tensor(0.6927, device='cuda:0') distillation_loss tensor(0.6570, device='cuda:0')
Iter:      0,  Train Loss:   1.8,  Train Acc: 37.50%,  Val Loss:   1.7,  Val Acc: 50.69%,  Time: 0:00:07 *,  LR: 0.0049863047384206835
0.0
base_loss tensor(0.8118, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4417, device='cuda:0', grad_fn=<MseLossBackward0>)
0.553005
base_loss tensor(0.9050, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4623, device='cuda:0', grad_fn=<MseLossBackward0>)
0.5404019
base_loss tensor(0.7195, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5929, device='cuda:0', grad_fn=<MseLossBackward0>)
0.3566664
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5154, device='cuda:0', grad_fn=<MseLossBackward0>)
0.2758563
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5459, device='cuda:0', grad_fn=<MseLossBackward0>)
0.19894588
base_loss tensor(0.8289, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5310, device='cuda:0', grad_fn=<MseLossBackward0>)
0.14640196
base_loss tensor(0.9070, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5841, device='cuda:0', grad_fn=<MseLossBackward0>)
0.109093376
base_loss tensor(0.7195, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4216, device='cuda:0', grad_fn=<MseLossBackward0>)
0.081942946
base_loss tensor(0.8601, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5644, device='cuda:0', grad_fn=<MseLossBackward0>)
0.061828304
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5288, device='cuda:0', grad_fn=<MseLossBackward0>)
0.04673118
base_loss tensor(0.8601, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5173, device='cuda:0', grad_fn=<MseLossBackward0>)
0.03532401
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5390, device='cuda:0', grad_fn=<MseLossBackward0>)
0.02664355
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5006, device='cuda:0', grad_fn=<MseLossBackward0>)
0.020030655
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4733, device='cuda:0', grad_fn=<MseLossBackward0>)
0.014942194
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4529, device='cuda:0', grad_fn=<MseLossBackward0>)
0.011061241
base_loss tensor(0.8289, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5309, device='cuda:0', grad_fn=<MseLossBackward0>)
0.008121302
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5919, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0058526555
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4215, device='cuda:0', grad_fn=<MseLossBackward0>)
0.004157152
base_loss tensor(0.9070, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5940, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0028811984
base_loss tensor(0.9383, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5153, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0019414126
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5179, device='cuda:0', grad_fn=<MseLossBackward0>)
0.001258264
base_loss tensor(0.9226, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5297, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0007801738
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5621, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0004549864
base_loss tensor(0.6726, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5246, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00024273725
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5469, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00011606816
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5153, device='cuda:0', grad_fn=<MseLossBackward0>)
4.6991918e-05
base_loss tensor(0.8289, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5161, device='cuda:0', grad_fn=<MseLossBackward0>)
1.5668624e-05
base_loss tensor(0.9383, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.6006, device='cuda:0', grad_fn=<MseLossBackward0>)
2.8881736e-06
base_loss tensor(0.9226, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4922, device='cuda:0', grad_fn=<MseLossBackward0>)
1.3612267e-07
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.6242, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5636, device='cuda:0', grad_fn=<MseLossBackward0>)
1.3254069e-07
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4698, device='cuda:0', grad_fn=<MseLossBackward0>)
2.774408e-06
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4690, device='cuda:0', grad_fn=<MseLossBackward0>)
1.4790686e-05
base_loss tensor(0.8289, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4372, device='cuda:0', grad_fn=<MseLossBackward0>)
4.3190063e-05
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5611, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00010404753
base_loss tensor(0.8601, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5563, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00021157924
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5147, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00038441902
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4853, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0006352765
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4338, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0009820558
base_loss tensor(0.8601, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5278, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0014445072
base_loss tensor(0.8601, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5312, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0020280536
base_loss tensor(0.7039, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4841, device='cuda:0', grad_fn=<MseLossBackward0>)
0.002747588
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4242, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0035975608
base_loss tensor(0.9226, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4301, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0046104197
base_loss tensor(0.9070, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4843, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0057213493
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5151, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0069819028
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.6401, device='cuda:0', grad_fn=<MseLossBackward0>)
0.008367712
base_loss tensor(0.7351, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4054, device='cuda:0', grad_fn=<MseLossBackward0>)
0.009807324
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4691, device='cuda:0', grad_fn=<MseLossBackward0>)
0.011322669
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5764, device='cuda:0', grad_fn=<MseLossBackward0>)
0.012864998
base_loss tensor(0.8445, device='cuda:0') distillation_loss tensor(0.4988, device='cuda:0')
0.0
base_loss tensor(0.6883, device='cuda:0') distillation_loss tensor(0.5603, device='cuda:0')
0.0
base_loss tensor(0.8601, device='cuda:0') distillation_loss tensor(0.6182, device='cuda:0')
0.0
base_loss tensor(0.9070, device='cuda:0') distillation_loss tensor(0.5615, device='cuda:0')
0.0
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.5406, device='cuda:0')
0.0
base_loss tensor(0.8289, device='cuda:0') distillation_loss tensor(0.4812, device='cuda:0')
0.0
base_loss tensor(0.7664, device='cuda:0') distillation_loss tensor(0.5125, device='cuda:0')
0.0
base_loss tensor(0.7820, device='cuda:0') distillation_loss tensor(0.5147, device='cuda:0')
0.0
base_loss tensor(0.6570, device='cuda:0') distillation_loss tensor(0.5372, device='cuda:0')
0.0
base_loss tensor(0.9226, device='cuda:0') distillation_loss tensor(0.4626, device='cuda:0')
0.0
base_loss tensor(0.7664, device='cuda:0') distillation_loss tensor(0.5054, device='cuda:0')
0.0
base_loss tensor(0.8133, device='cuda:0') distillation_loss tensor(0.5653, device='cuda:0')
0.0
base_loss tensor(0.8445, device='cuda:0') distillation_loss tensor(0.6459, device='cuda:0')
0.0
base_loss tensor(0.7820, device='cuda:0') distillation_loss tensor(0.4884, device='cuda:0')
0.0
base_loss tensor(0.8914, device='cuda:0') distillation_loss tensor(0.4658, device='cuda:0')
0.0
base_loss tensor(0.7820, device='cuda:0') distillation_loss tensor(0.4680, device='cuda:0')
0.0
base_loss tensor(0.8601, device='cuda:0') distillation_loss tensor(0.4867, device='cuda:0')
0.0
base_loss tensor(0.7508, device='cuda:0') distillation_loss tensor(0.4692, device='cuda:0')
0.0
base_loss tensor(0.6883, device='cuda:0') distillation_loss tensor(0.5750, device='cuda:0')
0.0
base_loss tensor(0.8289, device='cuda:0') distillation_loss tensor(0.5276, device='cuda:0')
0.0
base_loss tensor(0.8601, device='cuda:0') distillation_loss tensor(0.5356, device='cuda:0')
0.0
base_loss tensor(0.8289, device='cuda:0') distillation_loss tensor(0.4562, device='cuda:0')
0.0
base_loss tensor(0.9226, device='cuda:0') distillation_loss tensor(0.5762, device='cuda:0')
0.0
base_loss tensor(0.7195, device='cuda:0') distillation_loss tensor(0.5434, device='cuda:0')
0.0
base_loss tensor(0.8289, device='cuda:0') distillation_loss tensor(0.4047, device='cuda:0')
0.0
base_loss tensor(0.8601, device='cuda:0') distillation_loss tensor(0.5848, device='cuda:0')
0.0
base_loss tensor(0.9383, device='cuda:0') distillation_loss tensor(0.4683, device='cuda:0')
0.0
base_loss tensor(0.7195, device='cuda:0') distillation_loss tensor(0.5153, device='cuda:0')
0.0
base_loss tensor(0.8305, device='cuda:0') distillation_loss tensor(0.3552, device='cuda:0')
Iter:     50,  Train Loss:   2.0,  Train Acc: 42.19%,  Val Loss:   1.8,  Val Acc: 50.08%,  Time: 0:00:23 ,  LR: 0.003969463130731265
0.0
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5621, device='cuda:0', grad_fn=<MseLossBackward0>)
0.014418914
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5616, device='cuda:0', grad_fn=<MseLossBackward0>)
0.01592474
base_loss tensor(0.9226, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5791, device='cuda:0', grad_fn=<MseLossBackward0>)
0.017362649
base_loss tensor(0.8289, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4328, device='cuda:0', grad_fn=<MseLossBackward0>)
0.01871445
base_loss tensor(0.7664, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5311, device='cuda:0', grad_fn=<MseLossBackward0>)
0.019913023
base_loss tensor(0.6883, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4162, device='cuda:0', grad_fn=<MseLossBackward0>)
0.020939719
base_loss tensor(0.7351, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5812, device='cuda:0', grad_fn=<MseLossBackward0>)
0.021725843
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.6083, device='cuda:0', grad_fn=<MseLossBackward0>)
0.022364648
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5152, device='cuda:0', grad_fn=<MseLossBackward0>)
0.022740297
base_loss tensor(0.8601, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5643, device='cuda:0', grad_fn=<MseLossBackward0>)
0.022846073
base_loss tensor(0.9226, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.6282, device='cuda:0', grad_fn=<MseLossBackward0>)
0.022734359
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5683, device='cuda:0', grad_fn=<MseLossBackward0>)
0.022352893
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5777, device='cuda:0', grad_fn=<MseLossBackward0>)
0.021708675
base_loss tensor(1.0164, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5000, device='cuda:0', grad_fn=<MseLossBackward0>)
0.020917514
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5462, device='cuda:0', grad_fn=<MseLossBackward0>)
0.019886363
base_loss tensor(0.9070, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5303, device='cuda:0', grad_fn=<MseLossBackward0>)
0.018684063
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.3748, device='cuda:0', grad_fn=<MseLossBackward0>)
0.017329263
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5931, device='cuda:0', grad_fn=<MseLossBackward0>)
0.01588911
base_loss tensor(0.9539, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5310, device='cuda:0', grad_fn=<MseLossBackward0>)
0.014381802
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5627, device='cuda:0', grad_fn=<MseLossBackward0>)
0.012827196
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5495, device='cuda:0', grad_fn=<MseLossBackward0>)
0.011284913
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4819, device='cuda:0', grad_fn=<MseLossBackward0>)
0.009770345
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4527, device='cuda:0', grad_fn=<MseLossBackward0>)
0.008332057
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5309, device='cuda:0', grad_fn=<MseLossBackward0>)
0.006948196
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5036, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0056900196
base_loss tensor(0.8289, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4999, device='cuda:0', grad_fn=<MseLossBackward0>)
0.004581805
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4997, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0035720319
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5777, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0027253293
base_loss tensor(0.9070, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5617, device='cuda:0', grad_fn=<MseLossBackward0>)
0.002009167
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5857, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0014290015
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5621, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0009698252
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4075, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00062608405
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5145, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00037793088
base_loss tensor(0.7039, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.6052, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00020736322
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5934, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00010160307
base_loss tensor(0.9695, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4843, device='cuda:0', grad_fn=<MseLossBackward0>)
4.198664e-05
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4997, device='cuda:0', grad_fn=<MseLossBackward0>)
1.4329606e-05
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4366, device='cuda:0', grad_fn=<MseLossBackward0>)
2.6658145e-06
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5507, device='cuda:0', grad_fn=<MseLossBackward0>)
1.2450283e-07
base_loss tensor(0.8289, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.3964, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5305, device='cuda:0', grad_fn=<MseLossBackward0>)
1.2450283e-07
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4593, device='cuda:0', grad_fn=<MseLossBackward0>)
2.6658097e-06
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4839, device='cuda:0', grad_fn=<MseLossBackward0>)
1.4329536e-05
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5466, device='cuda:0', grad_fn=<MseLossBackward0>)
4.1986154e-05
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5273, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00010160071
base_loss tensor(0.9226, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5310, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00020735501
base_loss tensor(0.9695, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5153, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0003779083
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5137, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0006260278
base_loss tensor(0.7508, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5935, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0009697036
base_loss tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4949, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0014287521
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.4988, device='cuda:0')
0.0
base_loss tensor(0.7820, device='cuda:0') distillation_loss tensor(0.5603, device='cuda:0')
0.0
base_loss tensor(0.7508, device='cuda:0') distillation_loss tensor(0.6182, device='cuda:0')
0.0
base_loss tensor(0.7820, device='cuda:0') distillation_loss tensor(0.5615, device='cuda:0')
0.0
base_loss tensor(0.9383, device='cuda:0') distillation_loss tensor(0.5406, device='cuda:0')
0.0
base_loss tensor(0.8289, device='cuda:0') distillation_loss tensor(0.4812, device='cuda:0')
0.0
base_loss tensor(0.7664, device='cuda:0') distillation_loss tensor(0.5125, device='cuda:0')
0.0
base_loss tensor(0.8601, device='cuda:0') distillation_loss tensor(0.5147, device='cuda:0')
0.0
base_loss tensor(0.7039, device='cuda:0') distillation_loss tensor(0.5372, device='cuda:0')
0.0
base_loss tensor(0.6414, device='cuda:0') distillation_loss tensor(0.4626, device='cuda:0')
0.0
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.5054, device='cuda:0')
0.0
base_loss tensor(0.9851, device='cuda:0') distillation_loss tensor(0.5653, device='cuda:0')
0.0
base_loss tensor(0.9383, device='cuda:0') distillation_loss tensor(0.6459, device='cuda:0')
0.0
base_loss tensor(0.8445, device='cuda:0') distillation_loss tensor(0.4884, device='cuda:0')
0.0
base_loss tensor(0.7664, device='cuda:0') distillation_loss tensor(0.4658, device='cuda:0')
0.0
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.4680, device='cuda:0')
0.0
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.4867, device='cuda:0')
0.0
base_loss tensor(0.7664, device='cuda:0') distillation_loss tensor(0.4692, device='cuda:0')
0.0
base_loss tensor(0.7820, device='cuda:0') distillation_loss tensor(0.5750, device='cuda:0')
0.0
base_loss tensor(0.7508, device='cuda:0') distillation_loss tensor(0.5276, device='cuda:0')
0.0
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.5356, device='cuda:0')
0.0
base_loss tensor(0.8133, device='cuda:0') distillation_loss tensor(0.4562, device='cuda:0')
0.0
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.5762, device='cuda:0')
0.0
base_loss tensor(0.8445, device='cuda:0') distillation_loss tensor(0.5434, device='cuda:0')
0.0
base_loss tensor(0.8601, device='cuda:0') distillation_loss tensor(0.4047, device='cuda:0')
0.0
base_loss tensor(0.8289, device='cuda:0') distillation_loss tensor(0.5848, device='cuda:0')
0.0
base_loss tensor(0.7976, device='cuda:0') distillation_loss tensor(0.4683, device='cuda:0')
0.0
base_loss tensor(0.9383, device='cuda:0') distillation_loss tensor(0.5153, device='cuda:0')
0.0
base_loss tensor(0.7960, device='cuda:0') distillation_loss tensor(0.3552, device='cuda:0')
Iter:    100,  Train Loss:   1.8,  Train Acc: 53.12%,  Val Loss:   1.8,  Val Acc: 50.08%,  Time: 0:00:38 ,  LR: 0.001483158392310497
0.0
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5152, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0020087138
base_loss tensor(0.9226, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4531, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0027245346
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5831, device='cuda:0', grad_fn=<MseLossBackward0>)
0.0035707224
base_loss tensor(0.8914, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5470, device='cuda:0', grad_fn=<MseLossBackward0>)
0.00457973
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5149, device='cuda:0', grad_fn=<MseLossBackward0>)
0.005686909
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4373, device='cuda:0', grad_fn=<MseLossBackward0>)
0.006943662
base_loss tensor(0.6883, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.6269, device='cuda:0', grad_fn=<MseLossBackward0>)
0.008325663
base_loss tensor(1.0633, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.3749, device='cuda:0', grad_fn=<MseLossBackward0>)
Epoch [2/30]
0.009761592
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4685, device='cuda:0', grad_fn=<MseLossBackward0>)
0.011273246
base_loss tensor(0.7664, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4684, device='cuda:0', grad_fn=<MseLossBackward0>)
0.012812019
base_loss tensor(0.7976, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.4529, device='cuda:0', grad_fn=<MseLossBackward0>)
0.014362503
base_loss tensor(0.9070, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5153, device='cuda:0', grad_fn=<MseLossBackward0>)
0.015865134
base_loss tensor(0.7351, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5154, device='cuda:0', grad_fn=<MseLossBackward0>)
0.017300043
base_loss tensor(0.8758, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5459, device='cuda:0', grad_fn=<MseLossBackward0>)
0.01864912
base_loss tensor(0.8133, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5310, device='cuda:0', grad_fn=<MseLossBackward0>)
0.019845385
base_loss tensor(0.8445, device='cuda:0', grad_fn=<NllLossBackward0>) distillation_loss tensor(0.5841, device='cuda:0', grad_fn=<MseLossBackward0>)
Traceback (most recent call last):
  File "/home/huyiwen/CV/bilstm/distill.py", line 72, in <module>
    student_train(T_model, S_model, cfg, train_loader, test_loader)
  File "/home/huyiwen/CV/bilstm/student.py", line 116, in student_train
    s_outputs = S_model(texts)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/huyiwen/CV/bilstm/models/lstm_mpo.py", line 195, in forward
    print(np.sum((self.last - self.cur) ** 2))
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/lib/redirect.py", line 643, in write
    cb(data)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 2123, in <lambda>
    lambda data: self._console_raw_callback("stdout", data),
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 370, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1465, in _console_raw_callback
    self._backend.interface.publish_output_raw(name, data)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 618, in publish_output_raw
    self._publish_output_raw(o)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/interface/interface_shared.py", line 79, in _publish_output_raw
    self._publish(rec)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/huyiwen/miniconda3/envs/kd/lib/python3.10/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
KeyboardInterrupt
0.020870164